@page "/trade"
@using Need4Chat.Shared
@inject NavigationManager navigationManager





<h3>Trades</h3>






@code {

    TradeClient client = null;

    String Username = "tester";
    String message = string.Empty;

    /// <summary>
    /// Start chat client
    /// </summary>
    async Task Trade()
    {
        // check username is valid
        //if (string.IsNullOrWhiteSpace(username))
        //{
        //	message = "Please enter a name";
        //	return;
        //};

        try
        {
            //// remove old messages if any
            //messages.Clear()P;

            // Create the chat client
            string baseUrl = navigationManager.BaseUri;

            //newTradeMessage = new TradeMessage() { Username = Username, Mine = true, DateAndTime = DateTime.Now };

            client = new TradeClient(Username, baseUrl);

            //// add an event handler for incoming messages
            //client.MessageReceived += MessageReceived;
            //client.BulkMessagesReceived += BulkMessagesReceived;

            // start the client
            Console.WriteLine("Index: chat starting...");

            await client.StartAsync();
            Console.WriteLine("Index: chat started?");
        }
        catch (Exception e)
        {
            message = $"ERROR: Failed to start chat client: {e.Message}";
            Console.WriteLine(e.Message);
            Console.WriteLine(e.StackTrace);
        }
    }

    protected override async Task OnInitializedAsync()
    {
        await Trade();
    }

}
